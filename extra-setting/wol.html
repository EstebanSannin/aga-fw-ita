<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
	<title>Extra Settings &raquo; Wake On Lan</title>

	<link href="usr_main.css" rel="stylesheet" type="text/css">
	<link href="usr_menus.css" rel="stylesheet" type="text/css">
	<script src="usr_menus.js" type="text/javascript"></script>
	<script src="util.js" type="text/javascript"></script>
	<script src="ro_util.js" type="text/javascript"></script>

	<meta http-equiv="Pragma" content="no-cache">
<script type='text/javascript'>
<!-- hide

function addClick() {
   var loc = 'do.cgi?page=woladd';

   var code = 'location = "' + loc + '"';
   eval(code);
}

function removeClick(rml) {
   var lst = '';

   if (rml.length > 0) {
      for (i = 0; i < rml.length; i++) {
         if ( rml[i].checked == true )
            lst += rml[i].value + ',';
      }
   } else if ( rml.checked == true )
      lst = rml.value;
   
   if ( lst != '' ) {
      var loc = 'do.cgi?page=wol&action=remove&rmLst=' + lst;

      var code = 'location = "' + loc + '"';
      eval(code);
   }
}

function sendClick() {
   var lst = '';
   var lstM = '';
   var loc = '';
   
   with ( document.forms[0] ) {
      if (rml.length > 0) {
         for (i = 0; i < rml.length; i++) {
            if ( rml[i].checked == true )
               lst += rml[i].value + ',';
         }
      } else if ( rml.checked == true )
         lst = rml.value + ',';

      if ( rmlManual.checked == true ) {
         if ( isValidMacAddress(MacAddr.value) == false ) {
            msg = 'MAC address "' + MacAddr.value + '" is invalid. Please, use the following format: "00:11:22:33:44:55"';
            alert(msg);
            return;
         } else {
            lstM = MacAddr.value;
         }
      }
   }
      
   if ( lst != '' ) {
     loc += lst;
   }
   if ( lstM != '' ) {
      loc += lstM;
   }
   
   if ( loc != '' ) {
      loc = 'do.cgi?page=wol&action=send&rmLst=' + loc;
   
      var code = 'location = "' + loc + '"';
      eval(code);
   }
}

// done hiding -->
</script>
</head>

<body onload="initMenu();">

<img id="idImgHeader" src="p_red.gif">
<div id="idHeader">Extra Settings</div>

<script>createroMenu();</script>

<div id="idContent">

<h3>Wake On Lan</h3>

<%roGetWOLLastResult()%>

<p>Send a Wake On Lan packet to the following mac address</p>

<form>
<table border="1" cellpadding="4" cellspacing="0">
	<thead><tr>
		<th>MAC Address</th>
		<th>Description</th>
		<th>Select</th>
	</tr></thead>

	<%roGetWOLList()%>
	<tr>
	<td><input type='text' name='MacAddr' maxlength='17' id='MacAddr'></td>
	<td>Type here a MAC Address</td>
	<td align='center'><input type='checkbox' name='rmlManual' value=''></td>
	</tr>
</table>
<p><input type='button' onClick='sendClick()' value='Send packet'></p>
<p><input type='button' onClick='addClick()' value='Add'>
<input type='button' onClick='removeClick(this.form.rml)' value='Remove'></p>
</form>

</div>
<p class="clsCopyright"></p>
</body>
</html>
